generator client {
  provider = "prisma-client-js"
}
// hardcoded url for some reason it cant fetch my env will remove this soon
datasource db {
  provider  = "postgresql"
  url       = "postgresql://postgres.sxwzziejwsctipkgjnne:password@aws-0-ap-southeast-1.pooler.supabase.com:5432/postgres?pgbouncer=true"
  directUrl = "postgresql://postgres.sxwzziejwsctipkgjnne:password@aws-0-ap-southeast-1.pooler.supabase.com:5432/postgres"
}

model Credentials {
  id        String  @id
  password  String
  patientID String  @unique
  patient   Patient @relation(fields: [patientID], references: [patientID], onDelete: Cascade)
}

model Patient {
  patientID        String           @id @default(uuid())
  securityQuestion SecurityQuestion
  providers        Provider[]
  bookmarks        Bookmark[]
  credentials      Credentials?
  folders          Folder[]
}

model Region {
  name      String    @unique
  id        Int       @default(autoincrement())
  regionID  Int       @id @unique
  addresses Address[]
  pOrCs     POrC[]
}

model POrC {
  name      String    @unique
  regionID  Int
  pOrCID    Int       @id
  id        Int       @default(autoincrement())
  addresses Address[]
  cOrMs     COrM[]
  region    Region    @relation(fields: [regionID], references: [regionID])
}

model COrM {
  id        Int       @default(autoincrement())
  cOrMID    Int       @id
  name      String
  pOrCID    Int
  addresses Address[]
  brgys     Brgy[]
  pOrC      POrC      @relation(fields: [pOrCID], references: [pOrCID])
}

model Brgy {
  id        Int       @default(autoincrement())
  brgyID    Int       @id
  name      String
  cOrMID    Int
  addresses Address[]
  cOrM      COrM      @relation(fields: [cOrMID], references: [cOrMID])
}

model Address {
  addressID  String   @id @default(uuid())
  street     String
  facilityID String   @unique
  regionID   Int
  pOrCID     Int
  cOrMID     Int
  brgyID     Int
  brgy       Brgy     @relation(fields: [brgyID], references: [brgyID])
  cOrM       COrM     @relation(fields: [cOrMID], references: [cOrMID])
  facility   Facility @relation(fields: [facilityID], references: [facilityID])
  pOrC       POrC     @relation(fields: [pOrCID], references: [pOrCID])
  region     Region   @relation(fields: [regionID], references: [regionID])

  @@unique([regionID, pOrCID, cOrMID, brgyID, street])
}

model Facility {
  facilityID        String              @id @default(uuid())
  password          String
  name              String
  photo             String              @default("https://placehold.co/1920x1440/png")
  email             String?              @unique
  phoneNumber       String?              @unique
  facilityType      FacilityType?
  ownership         Ownership?
  LTO               String?
  COA               String?
  bookingSystem     String?
  acceptedProviders Provider[]
  address           Address?
  admins            Admin[]
  ambulanceService  AmbulanceService?
  bloodBankService  BloodBankService?
  bookmarks         Bookmark[]
  divisions         Division[]
  erService         ERService?
  icuService        ICUService?
  outpatientService OutpatientService[]
}

model Division {
  divisionID        String              @id @default(uuid())
  name              String
  phoneNumber       String
  openingTime       DateTime            @db.Time(0)
  closingTime       DateTime            @db.Time(0)
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  facilityID        String
  ambulanceService  AmbulanceService?
  bloodBankService  BloodBankService?
  facility          Facility            @relation(fields: [facilityID], references: [facilityID])
  erService         ERService?
  icuService        ICUService?
  outpatientService OutpatientService[]
  admins            Admin[]             @relation("AdminToDivision")
}

model Admin {
  password   String
  adminID    String     @id @default(uuid())
  facilityID String
  photo      String     @default("https://placehold.co/1080x1080/png")
  facility   Facility   @relation(fields: [facilityID], references: [facilityID], onDelete: Cascade)
  divisions  Division[] @relation("AdminToDivision")
}

model Bookmark {
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  patientID  String
  facilityID String
  folderID   String?
  facility   Facility @relation(fields: [facilityID], references: [facilityID], onDelete: Cascade)
  folder     Folder?  @relation(fields: [folderID], references: [folderID])
  patient    Patient  @relation(fields: [patientID], references: [patientID], onDelete: Cascade)

  @@id([patientID, facilityID])
}

model Folder {
  folderID  String     @id @default(uuid())
  name      String
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  patientID String
  bookmarks Bookmark[]
  patient   Patient    @relation(fields: [patientID], references: [patientID], onDelete: Cascade)

  @@unique([patientID, name])
}

model AmbulanceService {
  phoneNumber       String
  openingTime       DateTime     @db.Time(0)
  closingTime       DateTime     @db.Time(0)
  baseRate          Float
  minCoverageRadius Float
  mileageRate       Float
  maxCoverageRadius Float
  availability      Availability @default(UNAVAILABLE)
  createdAt         DateTime     @default(now())
  updatedAt         DateTime     @updatedAt
  facilityID        String       @id
  divisionID        String?      @unique
  division          Division?    @relation(fields: [divisionID], references: [divisionID])
  facility          Facility     @relation(fields: [facilityID], references: [facilityID], onDelete: Cascade)

  @@unique([facilityID, divisionID])
}

model BloodTypeMapping {
  A_P              Boolean          @default(false)
  A_N              Boolean          @default(false)
  B_P              Boolean          @default(false)
  B_N              Boolean          @default(false)
  O_P              Boolean          @default(false)
  O_N              Boolean          @default(false)
  AB_P             Boolean          @default(false)
  AB_N             Boolean          @default(false)
  facilityID       String           @id
  BloodBankService BloodBankService @relation(fields: [facilityID], references: [facilityID])
}

model BloodBankService {
  phoneNumber           String
  openingTime           DateTime          @db.Time(0)
  closingTime           DateTime          @db.Time(0)
  pricePerUnit          Float
  turnaroundTimeD       Int
  turnaroundTimeH       Int
  createdAt             DateTime          @default(now())
  updatedAt             DateTime          @updatedAt
  facilityID            String            @id
  divisionID            String?           @unique
  division              Division?         @relation(fields: [divisionID], references: [divisionID])
  facility              Facility          @relation(fields: [facilityID], references: [facilityID], onDelete: Cascade)
  bloodTypeAvailability BloodTypeMapping?

  @@unique([facilityID, divisionID])
}

model ERService {
  phoneNumber          String
  load                 Load      @default(CLOSED)
  availableBeds        Int       @default(0)
  nonUrgentPatients    Int       @default(0)
  nonUrgentQueueLength Int       @default(0)
  urgentPatients       Int       @default(0)
  urgentQueueLength    Int       @default(0)
  criticalPatients     Int       @default(0)
  criticalQueueLength  Int       @default(0)
  createdAt            DateTime  @default(now())
  updatedAt            DateTime  @updatedAt
  facilityID           String    @id
  divisionID           String?   @unique
  division             Division? @relation(fields: [divisionID], references: [divisionID])
  facility             Facility  @relation(fields: [facilityID], references: [facilityID], onDelete: Cascade)

  @@unique([facilityID, divisionID])
}

model ICUService {
  phoneNumber         String
  baseRate            Float
  load                Load
  availableBeds       Int       @default(0)
  cardiacSupport      Boolean   @default(false)
  neurologicalSupport Boolean   @default(false)
  renalSupport        Boolean   @default(false)
  respiratorySupport  Boolean   @default(false)
  createdAt           DateTime  @default(now())
  updatedAt           DateTime  @updatedAt
  facilityID          String    @id
  divisionID          String?   @unique
  division            Division? @relation(fields: [divisionID], references: [divisionID])
  facility            Facility  @relation(fields: [facilityID], references: [facilityID], onDelete: Cascade)

  @@unique([facilityID, divisionID])
}

model OutpatientService {
  serviceType     ServiceType
  price           Float
  completionTimeD Int
  completionTimeH Int
  isAvailable     Boolean     @default(false)
  acceptsWalkIns  Boolean
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
  facilityID      String
  divisionID      String?
  division        Division?   @relation(fields: [divisionID], references: [divisionID])
  facility        Facility    @relation(fields: [facilityID], references: [facilityID], onDelete: Cascade)

  @@id([facilityID, serviceType])
}

enum Provider {
  INTELLICARE
  ASIACARE
  AVEGA
  CAREWELL
  one_COOPHEALTH
  DYNAMIC_CARE_CORPORATION
  EASTWEST_HEALTHCARE
  FORTICARE
  GETWELL
  HC_and_D
  HEALTHFIRST
  HMI
  HPPI
  IWC
  ICARE
  KAISER
  LIFE_and_HEALTH
  MAXICARE
  MEDICARD
  MEDICARE
  MEDOCARE
  METROCARE
  OMHSI
  PACIFIC_CROSS
  PHILHEALTH
  VALUCARE
  WELLCARE
}

enum SecurityQuestion {
  STREETNAME
  FIRSTFRIENDNICKNAME
  FAVORITEOUTDOORGAME
  FIRSTPETNAME
  INFLUENTIALTEACHER
  FAVORITETVSHOW
  FAVORITEULAM
  UNUSUALSTREETFOOD
  FIRSTJOB
  MEMORABLEBIRTHDAYGIFT
}

enum FacilityType {
  BARANGAY_HEALTH_CENTER
  CLINIC
  HEALTH_CENTER
  HOSPITAL
  INFIRMARY
  POLYCLINIC
  PRIMARY_CARE_CLINIC
  CARDIOLOGY_CLINIC
  DENTAL_CLINIC
  DERMATOLOGY_CLINIC
  ENDOCRINOLOGY_CLINIC
  ENT_CLINIC
  FERTILITY_CLINIC
  GASTROENTEROLOGY_CLINIC
  IMMUNOLOGY_CENTER
  INFECTIOUS_DISEASE_CENTER
  MATERNITY_CENTER
  NEPHROLOGY_CLINIC
  NEUROLOGY_CLINIC
  ONCOLOGY_CENTER
  OPHTHALMOLOGY_CLINIC
  ORTHOPEDIC_CLINIC
  PEDIATRIC_CLINIC
  PULMONOLOGY_CLINIC
  RHEUMATOLOGY_CLINIC
  UROLOGY_CLINIC
  DIAGNOSTIC_LAB
  GENETIC_TESTING_LAB
  PATHOLOGY_LAB
  RADIOLOGY_CENTER
  BURN_CENTER
  CRITICAL_CARE_CENTER
  EMERGENCY_CENTER
  POISON_CONTROL_CENTER
  TRAUMA_CENTER
  URGENT_CARE_CENTER
  BLOOD_BANK
  DIALYSIS_CENTER
  MENTAL_HEALTH_FACILITY
  PAIN_MANAGEMENT_CLINIC
  REHABILITATION_CENTER
  SLEEP_CENTER
  SUBSTANCE_ABUSE_CENTER
  TRANSPLANT_CENTER
  ALTERNATIVE_MEDICINE_CENTER
  HERBAL_MEDICINE_CENTER
  PHYSICAL_THERAPY_CENTER
  AMBULATORY_CARE_CENTER
  SURGICAL_CENTER
  AMBULANCE_SERVICE
}

enum Ownership {
  PUBLIC
  PRIVATE
}

enum Availability {
  AVAILABLE
  SHORT_DELAY
  MODERATE_DELAY
  EXTENDED_DELAY
  UNAVAILABLE
}

enum Load {
  STEADY
  MODERATE
  CROWDED
  NEAR_CAPACITY
  FULL_CAPACITY
  CLOSED
}

enum ServiceType {
  CONSULTATION_GENERAL
  CONSULTATION_CARDIOLOGY
  CONSULTATION_DERMATOLOGY
  CONSULTATION_ENDOCRINOLOGY
  CONSULTATION_ENT
  CONSULTATION_GASTROENTEROLOGY
  CONSULTATION_NEUROLOGY
  CONSULTATION_OB_GYNE
  CONSULTATION_ONCOLOGY
  CONSULTATION_OPHTHALMOLOGY
  CONSULTATION_ORTHOPEDICS
  CONSULTATION_PEDIATRICS
  CONSULTATION_PSYCHIATRY
  CONSULTATION_PULMONOLOGY
  CONSULTATION_REHABILITATION
  CONSULTATION_RHEUMATOLOGY
  CONSULTATION_UROLOGY
  BLOOD_CHEMISTRY_BUA
  BLOOD_CHEMISTRY_BUN
  BLOOD_CHEMISTRY_CREATININE
  BLOOD_CHEMISTRY_FBS
  BLOOD_CHEMISTRY_RBS
  BLOOD_CHEMISTRY_CHOLESTEROL
  BLOOD_CHEMISTRY_TRIGLYCERIDES
  BLOOD_CHEMISTRY_HDL
  BLOOD_CHEMISTRY_LDL
  BLOOD_CHEMISTRY_AST
  BLOOD_CHEMISTRY_ALT
  BLOOD_CHEMISTRY_LDH
  BLOOD_CHEMISTRY_ELECTROLYTES
  HEMATOLOGY_CBC
  HEMATOLOGY_HEMOGLOBIN
  HEMATOLOGY_HEMATOCRIT
  HEMATOLOGY_PLATELET_COUNT
  HEMATOLOGY_COAGULATION
  HEMATOLOGY_CT_BT
  HEMATOLOGY_PERIPHERAL_SMEAR
  CLINICAL_FECALYSIS
  CLINICAL_URINALYSIS
  CLINICAL_OCCULT_BLOOD
  CLINICAL_SEMEN_ANALYSIS
  CLINICAL_BODY_FLUID_ANALYSIS
  CLINICAL_PREGNANCY_TEST
  BACTERIOLOGY_SPUTUM
  BACTERIOLOGY_GRAM_STAIN
  BACTERIOLOGY_CULTURE_SENS
  BACTERIOLOGY_THROAT_SWAB
  BACTERIOLOGY_BLOOD_CULTURE
  BACTERIOLOGY_URINE_CULTURE
  HISTOPATHOLOGY_PAPS
  HISTOPATHOLOGY_BIOPSY
  HISTOPATHOLOGY_CYTOLOGY
  X_RAY_CHEST_PA
  X_RAY_CHEST_AP_LAT
  X_RAY_SKULL_AP_LAT
  X_RAY_C_SPINE
  X_RAY_L_SPINE
  X_RAY_THORACIC_CAGE
  X_RAY_SHOULDER
  X_RAY_CLAVICLE
  X_RAY_ARM_AP_LAT
  X_RAY_HAND
  X_RAY_FOOT
  ULTRASOUND_ABDOMINAL
  ULTRASOUND_WHOLE_ABD
  ULTRASOUND_PELVIC
  ULTRASOUND_TRANSVAGINAL
  ULTRASOUND_THYROID
  ULTRASOUND_BREAST
  ULTRASOUND_KUB
  ULTRASOUND_OB
  ULTRASOUND_OB_NO_READING
  ULTRASOUND_DOPPLER
  ULTRASOUND_SCROTAL
  ULTRASOUND_PROSTATE
  CT_SCAN_HEAD
  CT_SCAN_BRAIN_STROKE
  CT_SCAN_SINUSES
  CT_SCAN_ANGIOGRAM_HEAD
  CT_SCAN_ANGIOGRAM_NECK
  CT_SCAN_CHEST
  CT_SCAN_CHEST_HRCT
  CT_SCAN_CHEST_PULMO_EMB
  CT_SCAN_ANGIOGRAM_CORONARY
  CT_SCAN_ABD
  CT_SCAN_ABD_PELVIS
  CT_SCAN_KUB
  CT_SCAN_ANGIOGRAM_ABD
  CT_SCAN_C_SPINE
  CT_SCAN_T_SPINE
  CT_SCAN_L_SPINE
  CT_SCAN_JOINT
  MRI_BRAIN
  MRI_C_SPINE
  MRI_T_SPINE
  MRI_L_SPINE
  MAMMOGRAPHY_BILATERAL
  MAMMOGRAPHY_UNILATERAL
  OPTICAL_REFRACTION
  OPTICAL_TONOMETRY
  OPTICAL_CHALAZION_REMOVAL
  OPTICAL_FOREIGN_BODY_REMOVAL
  OPTICAL_OCT_OPTIC_NERVE
  OPTICAL_OCT_MACULA
  HEARING_AUDIOMETRY
  HEARING_TYMPANOMETRY
  ENT_EAR_IRRIGATION
  ENT_EAR_WAX_REMOVAL
  ENT_NASAL_ENDOSCOPY
  ENT_LARYNGOSCOPY
  ENT_VIDEOSTROBOSCOPY
  DENTAL_EXTRACTION
  DENTAL_SCALING
  DENTAL_FILLING_TEMPORARY
  DENTAL_FILLING_PERMANENT
  DENTAL_ROOT_CANAL
  DENTAL_CROWN_PLACEMENT
  DENTAL_BRIDGE_PLACEMENT
  DENTAL_WHITENING
  THERAPY_PHYSICAL
  THERAPY_OCCUPATIONAL
  THERAPY_SPEECH
  THERAPY_RESPIRATORY
  THERAPY_VESTIBULAR
  THERAPY_CARDIAC
  THERAPY_LYMPHEDEMA
  THERAPY_NEUROLOGICAL
  ONCOLOGY_CHEMOTHERAPY
  ONCOLOGY_RADIATION_THERAPY
  ONCOLOGY_PALLIATIVE_CARE
  ONCOLOGY_HORMONAL_THERAPY
  ONCOLOGY_IMMUNOTHERAPY
  ONCOLOGY_TARGETED_THERAPY
  PROCEDURE_CAUTERIZATION
  PROCEDURE_CIRCUMCISION
  PROCEDURE_DEBRIDEMENT
  PROCEDURE_DRESSING
  PROCEDURE_EAR_PIERCING
  PROCEDURE_INCISION
  PROCEDURE_DRAINAGE
  PROCEDURE_WOUND_SUTURING
  PROCEDURE_WOUND_SUTURE_REMOVAL
  PROCEDURE_CYST_REMOVAL
  PROCEDURE_LIPOMA_REMOVAL
  PROCEDURE_SKIN_TAG_REMOVAL
  PROCEDURE_NAIL_REMOVAL
  PROCEDURE_WART_REMOVAL
  PROCEDURE_BIOPSY
  PROCEDURE_EEG
  PROCEDURE_ECG
  PROCEDURE_PFT
  PROCEDURE_DIALYSIS
  PROCEDURE_LUMBAR_TAP
  PROCEDURE_PARACENTESIS
  PROCEDURE_UMBILICAL_CATH
  PROCEDURE_COLONOSCOPY
  PROCEDURE_GASTROSCOPY
  PROCEDURE_BRONCHOSCOPY
  PROCEDURE_THORACENTESIS
  PROCEDURE_LABOR_DELIVERY
  VACCINATION_HEPATITIS_A
  VACCINATION_HEPATITIS_B
  VACCINATION_HPV
  VACCINATION_INFLUENZA
  VACCINATION_MMR
  VACCINATION_POLIO
  VACCINATION_RABIES
  VACCINATION_COVID19
  VACCINATION_ROTAVIRUS
  VACCINATION_PNEUMOCOCCAL
  VACCINATION_MENINGOCOCCAL
  VACCINATION_TDAP
}
